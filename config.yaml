log:
  level: warn

githubReleases:
  - owner: "kubevirt"
    repo: "kubevirt"
    assets:
      - "kubevirt-operator.yaml"
      - "kubevirt-cr.yaml"
    chart: "charts/kubevirt"
    drop:
      - namespace
      - namespaces
    modifications:
      - expression: '.metadata.namespace |= "{{ .Release.Namespace }}"'
        reject: "ClusterRole|ClusterRoleBinding|PriorityClass"
      - expression: '(.subjects[] | select(.name == "kubevirt-operator") .namespace) = "{{ .Release.Namespace }}"'
        kind: "RoleBinding|ClusterRoleBinding"
      - expression: '.spec.configuration |= "{{ .Values.kubevirt.configuration | toYaml | nindent 8 }}"'
        kind: KubeVirt
        valuesSelector: ".spec.configuration"
  - owner: "kubevirt"
    repo: "containerized-data-importer"
    assets:
      - "cdi-operator.yaml"
      - "cdi-cr.yaml"
    chart: "charts/cdi"
    drop:
      - namespace
      - namespaces
    modifications:
      - expression: '.metadata.namespace |= "{{ .Release.Namespace }}"'
        reject: "ClusterRole|ClusterRoleBinding|PriorityClass"
      - expression: '(.subjects[] | select(.name == "cdi-operator") .namespace) = "{{ .Release.Namespace }}"'
        kind: "RoleBinding|ClusterRoleBinding"
      - expression: '.spec.config |= "{{ .Values.cdi.config | toYaml | nindent 8 }}"'
        kind: CDI
        valuesSelector: ".spec.config"
      - expression: '.spec.infra |= "{{ .Values.cdi.infra | toYaml | nindent 8 }}"'
        kind: CDI
        valuesSelector: ".spec.infra"
      - expression: '.spec.workload |= "{{ .Values.cdi.workload | toYaml | nindent 8 }}"'
        kind: CDI
        valuesSelector: ".spec.workload"
